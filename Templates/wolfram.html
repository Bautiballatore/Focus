{% extends "base.html" %}

{% block title %}Ejercicios matemáticos - Wolfram Alpha{% endblock %}

{% block breadcrumb_items %}
<span class="separator">/</span>
<span class="current">Ejercicios Matemáticos</span>
{% endblock %}

{% block extra_styles %}
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
    /* Estilos específicos para la página de Wolfram */
    .page-header {
        text-align: center;
        margin-bottom: 40px;
        padding: 20px;
        background: rgba(255, 255, 255, 0.05);
        border-radius: 15px;
        backdrop-filter: blur(10px);
        margin-left: 360px;
        margin-right: 40px;
    }
    
    .page-title {
        color: var(--primary);
        font-size: 2.5rem;
        margin-bottom: 10px;
        font-family: 'Montserrat', Arial, sans-serif;
    }
    
    .page-subtitle {
        color: var(--text-light);
        font-size: 1.2rem;
        opacity: 0.9;
    }
    
    .container {
        max-width: 1800px;
        margin: 40px calc((100vw - 280px - 1800px) / 2) 40px calc(280px + (100vw - 280px - 1800px) / 2);
        background: linear-gradient(135deg, rgba(35, 38, 58, 0.95) 0%, rgba(45, 48, 68, 0.95) 100%);
        backdrop-filter: blur(20px);
        -webkit-backdrop-filter: blur(20px);
        border-radius: 24px;
        padding: 48px 56px;
        box-shadow: 
            0 12px 40px rgba(0, 0, 0, 0.4),
            0 4px 12px rgba(124, 58, 237, 0.1),
            inset 0 1px 0 rgba(255, 255, 255, 0.1);
        border: 1px solid rgba(148, 163, 184, 0.1);
        position: relative;
        overflow: hidden;
        transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    }
    
    .container:hover {
        transform: translateY(-2px);
        box-shadow: 
            0 20px 60px rgba(0, 0, 0, 0.5),
            0 8px 20px rgba(124, 58, 237, 0.15),
            inset 0 1px 0 rgba(255, 255, 255, 0.15);
    }
    
    .row {
        display: flex;
        gap: 16px;
        align-items: center;
    }
    
    select, input[type="text"] {
        padding: 18px 24px;
        border-radius: 16px;
        border: 2px solid rgba(148, 163, 184, 0.2);
        font-size: 1.1rem;
        background: linear-gradient(135deg, rgba(35, 38, 58, 0.8) 0%, rgba(45, 48, 68, 0.8) 100%);
        color: #fff;
        outline: none;
        transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        backdrop-filter: blur(10px);
        -webkit-backdrop-filter: blur(10px);
        box-shadow: 
            0 4px 12px rgba(0, 0, 0, 0.1),
            inset 0 1px 0 rgba(255, 255, 255, 0.05);
        position: relative;
    }
    
    select:focus, input[type="text"]:focus {
        border-color: var(--primary);
        box-shadow: 
            0 0 0 4px rgba(99, 102, 241, 0.15),
            0 8px 24px rgba(124, 58, 237, 0.2),
            inset 0 1px 0 rgba(255, 255, 255, 0.1);
        background: linear-gradient(135deg, rgba(35, 38, 58, 0.9) 0%, rgba(45, 48, 68, 0.9) 100%);
        transform: translateY(-1px);
    }
    
    select:hover, input[type="text"]:hover {
        border-color: rgba(148, 163, 184, 0.3);
        transform: translateY(-1px);
        box-shadow: 
            0 6px 16px rgba(0, 0, 0, 0.15),
            inset 0 1px 0 rgba(255, 255, 255, 0.08);
    }
    
    select {
        min-width: 200px;
        cursor: pointer;
    }
    
    input[type="text"] {
        flex: 1;
    }
    
    .symbols-bar {
        display: flex;
        flex-wrap: wrap;
        gap: 12px;
        margin-bottom: 16px;
        padding: 24px;
        background: linear-gradient(135deg, rgba(35, 38, 58, 0.4) 0%, rgba(45, 48, 68, 0.4) 100%);
        border-radius: 20px;
        border: 1px solid rgba(148, 163, 184, 0.15);
        backdrop-filter: blur(15px);
        -webkit-backdrop-filter: blur(15px);
        box-shadow: 
            0 8px 24px rgba(0, 0, 0, 0.1),
            inset 0 1px 0 rgba(255, 255, 255, 0.05);
        position: relative;
    }
    
    .symbol-btn {
        background: linear-gradient(135deg, rgba(35, 38, 58, 0.9) 0%, rgba(45, 48, 68, 0.9) 100%);
        color: var(--primary-light);
        border: 1px solid rgba(99, 102, 241, 0.25);
        border-radius: 12px;
        padding: 12px 18px;
        font-size: 1.1rem;
        cursor: pointer;
        transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        backdrop-filter: blur(10px);
        -webkit-backdrop-filter: blur(10px);
        font-weight: 500;
        position: relative;
        overflow: hidden;
        box-shadow: 
            0 4px 12px rgba(0, 0, 0, 0.1),
            inset 0 1px 0 rgba(255, 255, 255, 0.05);
    }
    
    .symbol-btn:hover {
        background: transparent;
        color: #fff;
        transform: translateY(-3px) scale(1.05);
        box-shadow: 
            0 12px 24px rgba(99, 102, 241, 0.3),
            0 4px 8px rgba(0, 0, 0, 0.2),
            inset 0 1px 0 rgba(255, 255, 255, 0.2);
        border-color: var(--primary-light);
    }
    
    button[type="submit"] {
        background: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 30%, var(--secondary) 100%);
        color: #fff;
        font-size: 1.2rem;
        font-weight: 700;
        border: none;
        border-radius: 16px;
        padding: 18px 36px;
        cursor: pointer;
        box-shadow: 
            0 8px 24px rgba(124, 58, 237, 0.4),
            0 4px 8px rgba(0, 0, 0, 0.1),
            inset 0 1px 0 rgba(255, 255, 255, 0.2);
        transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        margin-top: 20px;
        position: relative;
        overflow: hidden;
        align-self: center;
    }
    
    button[type="submit"]:hover {
        background: linear-gradient(135deg, var(--secondary) 0%, var(--primary-light) 30%, var(--primary) 100%);
        box-shadow: 
            0 16px 40px rgba(56, 189, 248, 0.5),
            0 8px 16px rgba(0, 0, 0, 0.2),
            inset 0 1px 0 rgba(255, 255, 255, 0.3);
        transform: translateY(-3px) scale(1.02);
    }
    
    .sugerencias {
        color: rgba(160, 174, 192, 0.9);
        font-size: 1rem;
        margin-bottom: 24px;
        padding: 24px;
        background: linear-gradient(135deg, rgba(99, 102, 241, 0.05) 0%, rgba(139, 92, 246, 0.05) 100%);
        border-radius: 20px;
        border: 1px solid rgba(99, 102, 241, 0.15);
        backdrop-filter: blur(15px);
        -webkit-backdrop-filter: blur(15px);
        box-shadow: 
            0 8px 24px rgba(0, 0, 0, 0.05),
            inset 0 1px 0 rgba(255, 255, 255, 0.05);
        position: relative;
    }
    
    .sugerencias b {
        color: var(--primary-light);
        font-weight: 600;
    }
    
    .sugerencias span {
        color: rgba(160, 174, 192, 0.8);
        font-family: 'SF Mono', 'Monaco', 'Inconsolata', monospace;
        background: rgba(35, 38, 58, 0.3);
        padding: 2px 6px;
        border-radius: 4px;
        border: 1px solid rgba(148, 163, 184, 0.1);
    }
    
    .ejercicios-sugeridos {
        margin-bottom: 24px;
    }
    
    .ej-lista {
        display: flex;
        flex-wrap: wrap;
        gap: 12px;
        margin-top: 16px;
    }
    
    .ej-item {
        background: rgba(124, 58, 237, 0.1);
        color: var(--primary-light);
        padding: 8px 16px;
        border-radius: 20px;
        cursor: pointer;
        transition: all 0.3s ease;
        border: 1px solid rgba(124, 58, 237, 0.2);
    }
    
    .ej-item:hover {
        background: rgba(124, 58, 237, 0.2);
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(124, 58, 237, 0.3);
    }
    
    .btn-main-examen {
        display: inline-block;
        background: linear-gradient(135deg, var(--accent) 0%, var(--accent-light) 100%);
        color: #fff;
        padding: 12px 24px;
        border-radius: 12px;
        text-decoration: none;
        font-weight: 600;
        margin-bottom: 24px;
        transition: all 0.3s ease;
        box-shadow: 0 4px 12px rgba(74, 222, 128, 0.3);
    }
    
    .btn-main-examen:hover {
        transform: translateY(-2px);
        box-shadow: 0 8px 20px rgba(74, 222, 128, 0.4);
    }
    
    .pods {
        margin-top: 32px;
    }
    
    .pod {
        background: linear-gradient(135deg, rgba(35, 38, 58, 0.95) 0%, rgba(45, 48, 68, 0.95) 100%);
        border-radius: 20px;
        box-shadow: 
            0 12px 32px rgba(124, 58, 237, 0.15),
            0 4px 12px rgba(0, 0, 0, 0.1),
            inset 0 1px 0 rgba(255, 255, 255, 0.1);
        margin-bottom: 24px;
        padding: 28px;
        border: 1px solid rgba(148, 163, 184, 0.15);
        backdrop-filter: blur(15px);
        -webkit-backdrop-filter: blur(15px);
        position: relative;
        overflow: hidden;
        transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    }
    
    .pod:hover {
        transform: translateY(-2px);
        box-shadow: 
            0 20px 48px rgba(124, 58, 237, 0.2),
            0 8px 16px rgba(0, 0, 0, 0.15),
            inset 0 1px 0 rgba(255, 255, 255, 0.15);
    }
    
    .pod-title {
        color: var(--primary-light);
        font-weight: 700;
        font-size: 1.3rem;
        margin-bottom: 16px;
        display: flex;
        align-items: center;
        gap: 12px;
    }
    
    .pod-content {
        font-size: 1.1rem;
        color: var(--text-light);
        line-height: 1.7;
    }
    
    .pod-content img {
        margin-top: 20px;
        max-width: 100%;
        background: #fff;
        border-radius: 16px;
        box-shadow: 
            0 12px 32px rgba(0, 0, 0, 0.3),
            0 4px 12px rgba(0, 0, 0, 0.1),
            inset 0 1px 0 rgba(255, 255, 255, 0.1);
        transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        border: 1px solid rgba(148, 163, 184, 0.1);
    }
    
    .pod-content img:hover {
        transform: scale(1.03) translateY(-4px);
        box-shadow: 
            0 20px 48px rgba(0, 0, 0, 0.4),
            0 8px 16px rgba(0, 0, 0, 0.2);
    }
    
    .error {
        color: #f87171;
        background: linear-gradient(135deg, rgba(45, 26, 26, 0.9) 0%, rgba(55, 30, 30, 0.9) 100%);
        border-radius: 12px;
        padding: 20px;
        margin-bottom: 20px;
        border: 1px solid rgba(248, 113, 113, 0.3);
    }
    
    .error h3 {
        margin-top: 0;
        color: #fca5a5;
    }

    .dropdown-toggle {
        cursor: pointer;
    }
    
    @media (max-width: 1024px) {
        .container {
            margin: 40px auto;
        }
        .page-header {
            margin-left: 40px;
            margin-right: 40px;
        }
    }
    
    @media (max-width: 768px) {
        .container {
            margin: 20px;
            padding: 24px;
        }
        .page-header {
            margin-left: 20px;
            margin-right: 20px;
        }
    }
</style>
{% endblock %}

{% block content %}
<!-- Page Header -->
<div class="page-header">
    <h1 class="page-title">
        <i class="fa-solid fa-calculator"></i> Ejercicios Matemáticos
    </h1>
    <p class="page-subtitle">
        Resuelve problemas matemáticos complejos con Wolfram Alpha
    </p>
</div>

<div class="container">
    <div class="sugerencias">
        <b>Ejemplos:</b> <span>integrate x^2, derivative of sin(x), solve x^2+2x+1=0, lim x→0 sin(x)/x</span><br>
        <b>Tip:</b> Podés escribir en español o inglés, o usar los botones de símbolos para armar tu fórmula.
    </div>
    <a href="/generar" class="btn-main-examen"><i class="fa-solid fa-file-circle-plus"></i> Generar examen</a>
    <div class="ejercicios-sugeridos">
        <b>Ejercicios sugeridos:</b>
        <div class="ej-lista">
            <span class="ej-item" onclick="setEjemplo('integrate x^2')">∫ x² dx</span>
            <span class="ej-item" onclick="setEjemplo('derivative of sin(x)')">Derivada de sin(x)</span>
            <span class="ej-item" onclick="setEjemplo('solve x^2+2x+1=0')">Resolver x²+2x+1=0</span>
            <span class="ej-item" onclick="setEjemplo('limit sin(x)/x as x→0')">Límite sin(x)/x cuando x→0</span>
            <span class="ej-item" onclick="setEjemplo('expand (x+1)^3')">Expandir (x+1)³</span>
            <span class="ej-item" onclick="setEjemplo('factor x^2-4')">Factorizar x²-4</span>
            <span class="ej-item" onclick="setEjemplo('plot x^2-3x+2')">Graficar x²-3x+2</span>
            <span class="ej-item" onclick="setEjemplo('simplify (x^2-1)/(x-1)')">Simplificar (x²-1)/(x-1)</span>
        </div>
    </div>
    
    <form method="POST">
        <div class="row">
            <select name="operacion" id="operacion">
                <option value="">Elige operación (opcional)</option>
                <option value="derivative">Derivada</option>
                <option value="integral">Integral</option>
                <option value="solve">Resolver ecuación</option>
                <option value="limit">Límite</option>
                <option value="simplify">Simplificar</option>
                <option value="expand">Expandir</option>
                <option value="factor">Factorizar</option>
                <option value="plot">Graficar</option>
                <option value="">Otra</option>
            </select>
            <input type="text" name="expresion" id="expresion" placeholder="Escribí la expresión o frase" required>
        </div>
        <div class="symbols-bar">
            <button type="button" class="symbol-btn" onclick="insertSymbol('^')">^</button>
            <button type="button" class="symbol-btn" onclick="insertSymbol('√')">√</button>
            <button type="button" class="symbol-btn" onclick="insertSymbol('∫')">∫</button>
            <button type="button" class="symbol-btn" onclick="insertSymbol('π')">π</button>
            <button type="button" class="symbol-btn" onclick="insertSymbol('∞')">∞</button>
            <button type="button" class="symbol-btn" onclick="insertSymbol('Δ')">Δ</button>
            <button type="button" class="symbol-btn" onclick="insertSymbol('≤')">≤</button>
            <button type="button" class="symbol-btn" onclick="insertSymbol('≥')">≥</button>
            <button type="button" class="symbol-btn" onclick="insertSymbol('→')">→</button>
            <button type="button" class="symbol-btn" onclick="insertSymbol('≈')">≈</button>
            <button type="button" class="symbol-btn" onclick="insertSymbol('≠')">≠</button>
            <button type="button" class="symbol-btn" onclick="insertSymbol('∂')">∂</button>
            <button type="button" class="symbol-btn" onclick="insertSymbol('log')">log</button>
            <button type="button" class="symbol-btn" onclick="insertSymbol('sin')">sin</button>
            <button type="button" class="symbol-btn" onclick="insertSymbol('cos')">cos</button>
            <button type="button" class="symbol-btn" onclick="insertSymbol('tan')">tan</button>
            <button type="button" class="symbol-btn" onclick="insertSymbol('e')">e</button>
        </div>
        <button type="submit"><i class="fa-solid fa-magnifying-glass"></i> Consultar</button>
    </form>
    <div class="pods">
        {% if error %}
            <div class="error">
                <h3>Error</h3>
                <p>{{ error }}</p>
            </div>
        {% endif %}
        
        {% if resultado %}
            <div class="pod">
                <h3 class="pod-title">Resultado</h3>
                <div class="pod-content">
                    <p>{{ resultado }}</p>
                    {% if imagen_url %}
                        <img src="{{ imagen_url }}" alt="Gráfico del resultado">
                    {% endif %}
                </div>
            </div>
        {% endif %}
        
        {% if pods %}
            {% for pod in pods %}
                {% if pod.title != "Resultado" and pod.title != "Result" %}
                    <div class="pod">
                        <h3 class="pod-title">{{ pod.title }}</h3>
                        <div class="pod-content">
                            {% if pod.plaintext %}
                                <p>{{ pod.plaintext }}</p>
                            {% endif %}
                            {% if pod.img %}
                                <img src="{{ pod.img }}" alt="{{ pod.title }}">
                            {% endif %}
                        </div>
                    </div>
                {% endif %}
            {% endfor %}
        {% endif %}
    </div>
{% endblock %}

{% block scripts %}
<script>
    function setEjemplo(ej) {
        document.getElementById('expresion').value = ej;
        document.getElementById('expresion').focus();
    }

    function insertSymbol(symbol) {
        const input = document.getElementById('expresion');
        const start = input.selectionStart;
        const end = input.selectionEnd;
        const text = input.value;
        input.value = text.slice(0, start) + symbol + text.slice(end);
        input.focus();
        input.selectionStart = input.selectionEnd = start + symbol.length;
    }
</script>
{% endblock %}
